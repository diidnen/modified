# @package _global_

defaults:
  - launcher: local
  - model: default
  - training: default
  - paths: juelich
  - datamodule: lung_healthy
  - _self_
  - override paths/anatomy: lung_healthy

############ Job specific configurations ############

name: hescape_default_training

model:
  litmodule:
    img_enc_name: uni
    img_finetune: true
    img_proj: moe
    gene_enc_name: scFoundation
    gene_finetune: true
    gene_proj: moe # mlp
    loss: CLIP
    temperature: 0.07

datamodule:
  seed: 24442
  batch_size: 64
  num_workers: 4
  pin_memory: true
  persistent_workers: true
  data_gene_reference_path: "/lus/lfs1aip1/home/u5t/chuhansong.u5t/UCFhescape/data/human-lung-healthy-panel/nicheformer_reference.h5ad"

  
training:
  lightning:
    trainer:
      max_steps: 20_000
      devices: ${devices_per_job}
      num_nodes: 1
      strategy: # "ddp"
        _target_: pytorch_lightning.strategies.DDPStrategy
        find_unused_parameters: true
        process_group_backend: "nccl"
      accelerator: "gpu"
  train: true
  test:
    false
    # profiler: simple

  logger:
    wandb:
      project: hescape_training



