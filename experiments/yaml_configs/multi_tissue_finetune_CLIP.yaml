# @package _global_

defaults:
  - launcher: juelich
  - model: default
  - training: default
  - paths: juelich
  - datamodule: multi_tissue
  - _self_
  - override paths/anatomy: multi_tissue

############ Job specific configurations ############

name: human_multi_tissue_panel

# model:
#   litmodule:
#     img_enc_name: optimus
#     img_finetune: false
#     gene_enc_name: drvi
#     gene_finetune: false
#     img_proj: transformer
#     loss: CLIP
#     temperature: 0.07

# datamodule:
#   seed: 24442
#   batch_size: 64
#   num_workers: 12

training:
  lightning:
    trainer:
      max_steps: 20_000
      devices: ${hydra:launcher.tasks_per_node}
      num_nodes: 1
      strategy: # "ddp"
        _target_: pytorch_lightning.strategies.DDPStrategy
      accelerator: "gpu"
  train: true
  test:
    false
    # profiler: simple

  logger:
    wandb:
      project: multi_tissue_panel
#       # name: "uni-drvi-siglip"

############ Hydra specific configurations ############
hydra:
  job:
    name: human_multi_tissue_panel
  sweeper:
    params:
      model.litmodule.img_enc_name: gigapath, conch, ctranspath, uni
      model.litmodule.img_finetune: true # Lora finetune
      model.litmodule.img_proj: mlp # linear
      model.litmodule.gene_enc_name: drvi, generic, nicheformer # scFoundation
      model.litmodule.gene_finetune: false # lora or full fine-tune
      model.litmodule.gene_proj: linear # mlp
      model.litmodule.loss: CLIP # SIGLIP
      model.litmodule.temperature: 0.07 # 0.5
      datamodule.seed: 24442, 422244 #, 42424244
      datamodule.batch_size: 64 #, 1024
      datamodule.num_workers: 12
      training.train: true
      training.test: false
